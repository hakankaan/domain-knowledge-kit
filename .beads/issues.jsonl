{"id":"domain-knowledge-kit-0m0","title":"Moves","description":"| From | To |","status":"tombstone","priority":2,"issue_type":"task","created_at":"2026-02-20T19:20:00.797687+03:00","updated_at":"2026-02-20T19:20:17.575891+03:00","deleted_at":"2026-02-20T19:20:17.575891+03:00","deleted_by":"batch delete","delete_reason":"batch delete","original_type":"task"}
{"id":"domain-knowledge-kit-0yj","title":"Acceptance Criteria","description":"- No orphan empty directories remain under `src/`","status":"tombstone","priority":2,"issue_type":"task","created_at":"2026-02-20T19:20:01.113638+03:00","updated_at":"2026-02-20T19:20:17.575891+03:00","deleted_at":"2026-02-20T19:20:17.575891+03:00","deleted_by":"batch delete","delete_reason":"batch delete","original_type":"task"}
{"id":"domain-knowledge-kit-1po","title":"Quality Gates","description":"After creating the ADR:","status":"tombstone","priority":2,"issue_type":"task","created_at":"2026-02-20T19:20:01.198202+03:00","updated_at":"2026-02-20T19:20:17.575891+03:00","deleted_at":"2026-02-20T19:20:17.575891+03:00","deleted_by":"batch delete","delete_reason":"batch delete","original_type":"task"}
{"id":"domain-knowledge-kit-23d","title":"Moves","description":"| From | To |","status":"tombstone","priority":2,"issue_type":"task","created_at":"2026-02-20T19:20:00.773548+03:00","updated_at":"2026-02-20T19:20:17.575891+03:00","deleted_at":"2026-02-20T19:20:17.575891+03:00","deleted_by":"batch delete","delete_reason":"batch delete","original_type":"task"}
{"id":"domain-knowledge-kit-23w","title":"Acceptance Criteria","description":"- ADR file exists at `docs/adr/adr-NNNN.md` with correct YAML frontmatter","status":"tombstone","priority":2,"issue_type":"task","created_at":"2026-02-20T19:20:01.238168+03:00","updated_at":"2026-02-20T19:20:17.575891+03:00","deleted_at":"2026-02-20T19:20:17.575891+03:00","deleted_by":"batch delete","delete_reason":"batch delete","original_type":"task"}
{"id":"domain-knowledge-kit-2x1","title":"Cleanup Tasks","description":"1. **Remove empty directories**: Verify and remove `src/commands/`, `src/core/`, `src/types/`, `src/utils/` if they still exist","status":"tombstone","priority":2,"issue_type":"task","created_at":"2026-02-20T19:20:01.006949+03:00","updated_at":"2026-02-20T19:20:17.575891+03:00","deleted_at":"2026-02-20T19:20:17.575891+03:00","deleted_by":"batch delete","delete_reason":"batch delete","original_type":"task"}
{"id":"domain-knowledge-kit-3cg","title":"PM Investigate: Duplicate of t8l.8 - stale output files (re: domain-knowledge-kit-3eu)","status":"closed","priority":2,"issue_type":"task","owner":"kaanhakan2005@gmail.com","created_at":"2026-02-20T18:12:46.076904+03:00","created_by":"Kaan Akın","updated_at":"2026-02-20T18:28:33.908959+03:00","closed_at":"2026-02-20T18:28:33.908959+03:00","close_reason":"Duplicate investigation; see t8l.8.","labels":["pm_investigate"]}
{"id":"domain-knowledge-kit-3eu","title":"Renderer doesn't clean stale output files","description":"When a context or domain item is removed from the YAML model, the renderer (src/core/renderer.ts) writes new docs but never removes orphaned files from docs/domain/. This leaves stale documentation that can mislead users. The renderer should compare the set of expected output files against what exists in the output directory and remove any files that are no longer generated.","status":"closed","priority":2,"issue_type":"task","owner":"kaanhakan2005@gmail.com","created_at":"2026-02-20T17:48:01.404999+03:00","created_by":"Kaan Akın","updated_at":"2026-02-20T18:28:34.020966+03:00","closed_at":"2026-02-20T18:28:34.020966+03:00","close_reason":"Duplicate of t8l.8."}
{"id":"domain-knowledge-kit-570","title":"Test Script Update","description":"Update `package.json` `test` script to discover tests at new locations. Options:","status":"tombstone","priority":2,"issue_type":"task","created_at":"2026-02-20T19:20:00.878932+03:00","updated_at":"2026-02-20T19:20:17.575891+03:00","deleted_at":"2026-02-20T19:20:17.575891+03:00","deleted_by":"batch delete","delete_reason":"batch delete","original_type":"task"}
{"id":"domain-knowledge-kit-6d9","title":"Import Updates","description":"Each command will import shared modules from `../../shared/`:","status":"tombstone","priority":2,"issue_type":"task","created_at":"2026-02-20T19:20:00.755459+03:00","updated_at":"2026-02-20T19:20:17.575891+03:00","deleted_at":"2026-02-20T19:20:17.575891+03:00","deleted_by":"batch delete","delete_reason":"batch delete","original_type":"task"}
{"id":"domain-knowledge-kit-6z5","title":"Rationale for Grouping","description":"These 4 commands share a common pattern: they are all read-only operations that explore the domain model. `list` and `show` are simple lookups, while `search` and `related` add FTS5 and graph traversal respectively. The `searcher.ts` module is only used by the search command, making it slice-private.","status":"tombstone","priority":2,"issue_type":"task","created_at":"2026-02-20T19:20:00.749291+03:00","updated_at":"2026-02-20T19:20:17.575891+03:00","deleted_at":"2026-02-20T19:20:17.575891+03:00","deleted_by":"batch delete","delete_reason":"batch delete","original_type":"task"}
{"id":"domain-knowledge-kit-7o2","title":"Rationale","description":"These are the simplest commands in the codebase. They only depend on:","status":"tombstone","priority":2,"issue_type":"task","created_at":"2026-02-20T19:20:00.779578+03:00","updated_at":"2026-02-20T19:20:17.575891+03:00","deleted_at":"2026-02-20T19:20:17.575891+03:00","deleted_by":"batch delete","delete_reason":"batch delete","original_type":"task"}
{"id":"domain-knowledge-kit-8sr","title":"Index ADR body text for FTS5 search","description":"Currently only ADR frontmatter metadata (title, status, domain_refs) is indexed for search. The Markdown body content (Context, Decision, Consequences sections) is excluded from the FTS5 search index. Indexing the body would make 'search' more useful for finding ADRs by their content.","status":"closed","priority":3,"issue_type":"task","owner":"kaanhakan2005@gmail.com","created_at":"2026-02-20T17:48:22.356118+03:00","created_by":"Kaan Akın","updated_at":"2026-02-20T18:28:34.611574+03:00","closed_at":"2026-02-20T18:28:34.611574+03:00","close_reason":"Duplicate of t8l.11."}
{"id":"domain-knowledge-kit-8xp","title":"Acceptance Criteria","description":"- All 4 commands (`list`, `show`, `search`, `related`) work identically via CLI","status":"tombstone","priority":2,"issue_type":"task","created_at":"2026-02-20T19:20:00.767511+03:00","updated_at":"2026-02-20T19:20:17.575891+03:00","deleted_at":"2026-02-20T19:20:17.575891+03:00","deleted_by":"batch delete","delete_reason":"batch delete","original_type":"task"}
{"id":"domain-knowledge-kit-92c","title":"Import Updates","description":"All test files use relative imports to core modules. These need updating to point at new shared/feature locations.","status":"tombstone","priority":2,"issue_type":"task","created_at":"2026-02-20T19:20:00.887284+03:00","updated_at":"2026-02-20T19:20:17.575891+03:00","deleted_at":"2026-02-20T19:20:17.575891+03:00","deleted_by":"batch delete","delete_reason":"batch delete","original_type":"task"}
{"id":"domain-knowledge-kit-93q","title":"Build Verification","description":"```bash","status":"tombstone","priority":2,"issue_type":"task","created_at":"2026-02-20T19:20:01.046604+03:00","updated_at":"2026-02-20T19:20:17.575891+03:00","deleted_at":"2026-02-20T19:20:17.575891+03:00","deleted_by":"batch delete","delete_reason":"batch delete","original_type":"task"}
{"id":"domain-knowledge-kit-9lw","title":"Target State","description":"```typescript","status":"tombstone","priority":2,"issue_type":"task","created_at":"2026-02-20T19:20:00.844421+03:00","updated_at":"2026-02-20T19:20:17.575891+03:00","deleted_at":"2026-02-20T19:20:17.575891+03:00","deleted_by":"batch delete","delete_reason":"batch delete","original_type":"task"}
{"id":"domain-knowledge-kit-bjx","title":"What Might Break","description":"- If the CLI `parseAsync()` call or error formatting changed","status":"tombstone","priority":2,"issue_type":"task","created_at":"2026-02-20T19:20:00.941493+03:00","updated_at":"2026-02-20T19:20:17.575891+03:00","deleted_at":"2026-02-20T19:20:17.575891+03:00","deleted_by":"batch delete","delete_reason":"batch delete","original_type":"task"}
{"id":"domain-knowledge-kit-cbc","title":"Moves","description":"| From | To |","status":"tombstone","priority":2,"issue_type":"task","created_at":"2026-02-20T19:20:00.742554+03:00","updated_at":"2026-02-20T19:20:17.575891+03:00","deleted_at":"2026-02-20T19:20:17.575891+03:00","deleted_by":"batch delete","delete_reason":"batch delete","original_type":"task"}
{"id":"domain-knowledge-kit-cte","title":"Additional Changes","description":"1. **Extract error formatting**: Move `formatCliError()`, `isYAMLException()`, `isNodeSystemError()` helper functions to `src/shared/errors.ts` since they are presentation infrastructure, not feature logic","status":"tombstone","priority":2,"issue_type":"task","created_at":"2026-02-20T19:20:00.8498+03:00","updated_at":"2026-02-20T19:20:17.575891+03:00","deleted_at":"2026-02-20T19:20:17.575891+03:00","deleted_by":"batch delete","delete_reason":"batch delete","original_type":"task"}
{"id":"domain-knowledge-kit-d97","title":"Import Update Scope","description":"Every file that imports from `../types/`, `../utils/`, `../core/loader`, or `../core/graph` needs updating:","status":"tombstone","priority":2,"issue_type":"task","created_at":"2026-02-20T19:20:00.730225+03:00","updated_at":"2026-02-20T19:20:17.575891+03:00","deleted_at":"2026-02-20T19:20:17.575891+03:00","deleted_by":"batch delete","delete_reason":"batch delete","original_type":"task"}
{"id":"domain-knowledge-kit-dg2","title":"PM Investigate: Duplicate of t8l.7 - files field (re: domain-knowledge-kit-xto)","status":"closed","priority":2,"issue_type":"task","owner":"kaanhakan2005@gmail.com","created_at":"2026-02-20T18:13:06.049134+03:00","created_by":"Kaan Akın","updated_at":"2026-02-20T18:28:14.74652+03:00","closed_at":"2026-02-20T18:28:14.74652+03:00","close_reason":"Confirmed duplicate of domain-knowledge-kit-t8l.7 (work already closed under t8l.7).","labels":["pm_investigate"]}
{"id":"domain-knowledge-kit-dgp","title":"Acceptance Criteria","description":"- `validate` and `render` CLI commands work identically to before","status":"tombstone","priority":2,"issue_type":"task","created_at":"2026-02-20T19:20:00.832867+03:00","updated_at":"2026-02-20T19:20:17.575891+03:00","deleted_at":"2026-02-20T19:20:17.575891+03:00","deleted_by":"batch delete","delete_reason":"batch delete","original_type":"task"}
{"id":"domain-knowledge-kit-dya","title":"PM Investigate: Duplicate of t8l.10 - CLI integration tests (re: domain-knowledge-kit-v37)","status":"closed","priority":2,"issue_type":"task","owner":"kaanhakan2005@gmail.com","created_at":"2026-02-20T18:13:14.683974+03:00","created_by":"Kaan Akın","updated_at":"2026-02-20T18:28:34.384413+03:00","closed_at":"2026-02-20T18:28:34.384413+03:00","close_reason":"Duplicate investigation; see t8l.10.","labels":["pm_investigate"]}
{"id":"domain-knowledge-kit-ecm","title":"File Naming","description":"Follow existing ADR convention: `docs/adr/adr-NNNN.md` with YAML frontmatter including `domain_refs` for any related domain items.","status":"tombstone","priority":2,"issue_type":"task","created_at":"2026-02-20T19:20:01.168441+03:00","updated_at":"2026-02-20T19:20:17.575891+03:00","deleted_at":"2026-02-20T19:20:17.575891+03:00","deleted_by":"batch delete","delete_reason":"batch delete","original_type":"task"}
{"id":"domain-knowledge-kit-f0h","title":"Acceptance Criteria","description":"- `adr show` and `adr related` CLI commands work identically to before","status":"tombstone","priority":2,"issue_type":"task","created_at":"2026-02-20T19:20:00.791963+03:00","updated_at":"2026-02-20T19:20:17.575891+03:00","deleted_at":"2026-02-20T19:20:17.575891+03:00","deleted_by":"batch delete","delete_reason":"batch delete","original_type":"task"}
{"id":"domain-knowledge-kit-fcn","title":"Test Groups to Verify (10 groups)","description":"1. **validate** -- ok, fail, json output","status":"tombstone","priority":2,"issue_type":"task","created_at":"2026-02-20T19:20:00.931854+03:00","updated_at":"2026-02-20T19:20:17.575891+03:00","deleted_at":"2026-02-20T19:20:17.575891+03:00","deleted_by":"batch delete","delete_reason":"batch delete","original_type":"task"}
{"id":"domain-knowledge-kit-gas","title":"Implementation Steps","description":"1. Create directory structure: `src/shared/types/`","status":"tombstone","priority":2,"issue_type":"task","created_at":"2026-02-20T19:20:00.724842+03:00","updated_at":"2026-02-20T19:20:17.575891+03:00","deleted_at":"2026-02-20T19:20:17.575891+03:00","deleted_by":"batch delete","delete_reason":"batch delete","original_type":"task"}
{"id":"domain-knowledge-kit-gtx","title":"Acceptance Criteria","description":"- `src/shared/` directory exists with all moved files","status":"tombstone","priority":2,"issue_type":"task","created_at":"2026-02-20T19:20:00.73603+03:00","updated_at":"2026-02-20T19:20:17.575891+03:00","deleted_at":"2026-02-20T19:20:17.575891+03:00","deleted_by":"batch delete","delete_reason":"batch delete","original_type":"task"}
{"id":"domain-knowledge-kit-hin","title":"Bootstrap Domain Knowledge Pack (YAML + ADR links + deterministic search + generated docs)","description":"Problem/goal: Establish a repo-native, Event-Storming-first domain knowledge system where structured domain items in-repo (YAML) are the canonical source of truth, with deterministic retrieval for Copilot workflows. Scope (in): Canonical domain item model (events/commands/policies/aggregates/read models/actors/glossary/contexts), generated Markdown docs derived from the model (.gitignored, on demand), ADR format and bidirectional linking, TypeScript/Node.js CLI with SQLite FTS5 for validate/render/search/show/related. Copilot integration via copilot-instructions.md + prompt workflows + optional Agent Skill. No custom agent. Scope (out): API contracts/specs, dev env docs, CI enforcement, implementation topology, custom Copilot agent files, sample data. Decisions: TS/Node CLI, SQLite FTS5 from v1, generated docs .gitignored, no sample data, no custom agent. Decomposed into child issues.","notes":"Acceptance Criteria:\\n- Canonical domain items exist as structured, stable-ID domain artifacts with bounded-context scoping (events/commands/policies/aggregates/read models/actors/glossary/contexts).\\n- ADRs support frontmatter domain references and resolve bidirectionally with domain item ADR references (no dangling refs).\\n- Local CLI supports: validate (IDs/refs), render (deterministic docs), search (deterministic lexical + metadata), show, and related (graph expansion).\\n- Generated docs are reproducible from the canonical model and templates, producing consistent output under docs/domain/.\\n- Copilot artifacts exist to enforce domain-first retrieval and canonical model updates when domain behavior changes.\\n- Retrieval introduces no embeddings, vector DB, or semantic dependency.\\n\\nOpen questions / assumptions:\\n- Preferred CLI language/runtime (Node/TS vs Python vs Go).\\n- Whether to include SQLite FTS5 indexing in v1 vs defer.\\n- Whether generated docs are committed by default.","status":"closed","priority":2,"issue_type":"epic","owner":"kaanhakan2005@gmail.com","created_at":"2026-02-20T12:43:48.138014+03:00","created_by":"Kaan Akın","updated_at":"2026-02-20T18:10:41.33568+03:00","closed_at":"2026-02-20T18:10:41.33568+03:00","close_reason":"Closed"}
{"id":"domain-knowledge-kit-hin.1","title":"Project infrastructure: package.json, tsconfig, deps, .gitignore","description":"Initialize Node.js project at repo root: package.json (type: module), tsconfig.json (ES2022/Node18+, output dist/), dev deps (typescript, tsx, better-sqlite3, js-yaml, ajv, handlebars, commander, fast-glob), root .gitignore (node_modules/, dist/, docs/domain/, .domain-pack/), bin entry for dist/cli.js, scripts for build and dev.","status":"closed","priority":1,"issue_type":"task","owner":"kaanhakan2005@gmail.com","created_at":"2026-02-20T13:38:18.282814+03:00","created_by":"Kaan Akın","updated_at":"2026-02-20T13:49:53.105263+03:00","closed_at":"2026-02-20T13:49:53.105263+03:00","close_reason":"Closed","dependencies":[{"issue_id":"domain-knowledge-kit-hin.1","depends_on_id":"domain-knowledge-kit-hin","type":"parent-child","created_at":"2026-02-20T13:38:18.283928+03:00","created_by":"Kaan Akın"}]}
{"id":"domain-knowledge-kit-hin.10","title":"CLI wiring: Commander-based entry point","description":"Implement src/cli.ts and src/commands/*.ts: wire all commands via Commander. Commands: domain list [--context][--type] (filter+table), domain show \u003cid\u003e (full YAML), domain search \u003cquery\u003e [--context][--type][--tag] (FTS5+ranked), domain related \u003cid\u003e [--depth] (graph traversal), domain validate (schema+xref, exit code), domain render (validate+render+count), domain adr show \u003cadr-id\u003e (print ADR), domain adr related \u003cid\u003e (bidirectional domain-ADR links). Each command in its own file under src/commands/.","status":"closed","priority":2,"issue_type":"task","owner":"kaanhakan2005@gmail.com","created_at":"2026-02-20T13:39:22.756822+03:00","created_by":"Kaan Akın","updated_at":"2026-02-20T16:59:27.343159+03:00","closed_at":"2026-02-20T16:59:27.343159+03:00","close_reason":"Closed","dependencies":[{"issue_id":"domain-knowledge-kit-hin.10","depends_on_id":"domain-knowledge-kit-hin","type":"parent-child","created_at":"2026-02-20T13:39:22.758036+03:00","created_by":"Kaan Akın"},{"issue_id":"domain-knowledge-kit-hin.10","depends_on_id":"domain-knowledge-kit-hin.6","type":"blocks","created_at":"2026-02-20T13:40:34.948512+03:00","created_by":"Kaan Akın"},{"issue_id":"domain-knowledge-kit-hin.10","depends_on_id":"domain-knowledge-kit-hin.8","type":"blocks","created_at":"2026-02-20T13:40:38.239253+03:00","created_by":"Kaan Akın"},{"issue_id":"domain-knowledge-kit-hin.10","depends_on_id":"domain-knowledge-kit-hin.9","type":"blocks","created_at":"2026-02-20T13:40:41.491585+03:00","created_by":"Kaan Akın"}]}
{"id":"domain-knowledge-kit-hin.11","title":"Copilot integration: instructions + prompts + skill","description":"Create Copilot artifacts (no custom agent file). 1) .github/copilot-instructions.md: core rules for domain-first retrieval, prefer YAML edits, update invariants/ADRs, run domain render. 2) .github/prompts/domain_search.prompt.md: user request -\u003e domain search -\u003e relevant IDs + excerpts + ADRs. 3) .github/prompts/domain_change_review.prompt.md: change summary -\u003e impacted items + invariants + ADRs. 4) .github/prompts/domain_update.prompt.md: change intent -\u003e YAML patches + ADR suggestions + render. 5) .github/skills/domain-knowledge/skill.md: portable Agent Skill describing canonical model, retrieval, update rules.","status":"closed","priority":2,"issue_type":"task","owner":"kaanhakan2005@gmail.com","created_at":"2026-02-20T13:39:31.680192+03:00","created_by":"Kaan Akın","updated_at":"2026-02-20T17:21:17.924789+03:00","closed_at":"2026-02-20T17:21:17.924789+03:00","close_reason":"Closed","dependencies":[{"issue_id":"domain-knowledge-kit-hin.11","depends_on_id":"domain-knowledge-kit-hin","type":"parent-child","created_at":"2026-02-20T13:39:31.681027+03:00","created_by":"Kaan Akın"}]}
{"id":"domain-knowledge-kit-hin.12","title":"README.md + AGENTS.md update","description":"Create README.md at repo root: what the package is, quick start (npm install, npx domain validate, npx domain render), directory layout reference, how to add a bounded context, how to add an ADR and link it, CLI command reference, link to Copilot integration. Update AGENTS.md: document domain CLI commands available to agents, convention that domain YAML is source of truth, instruction to run domain validate + domain render as quality gates when domain files change.","status":"closed","priority":3,"issue_type":"task","owner":"kaanhakan2005@gmail.com","created_at":"2026-02-20T13:39:38.87411+03:00","created_by":"Kaan Akın","updated_at":"2026-02-20T17:25:26.862124+03:00","closed_at":"2026-02-20T17:25:26.862124+03:00","close_reason":"Closed","dependencies":[{"issue_id":"domain-knowledge-kit-hin.12","depends_on_id":"domain-knowledge-kit-hin","type":"parent-child","created_at":"2026-02-20T13:39:38.874846+03:00","created_by":"Kaan Akın"},{"issue_id":"domain-knowledge-kit-hin.12","depends_on_id":"domain-knowledge-kit-hin.10","type":"blocks","created_at":"2026-02-20T13:40:44.910702+03:00","created_by":"Kaan Akın"}]}
{"id":"domain-knowledge-kit-hin.13","title":"Verification: build + validate + render + search on empty scaffolding","description":"End-to-end verification: npm run build compiles without errors, npx domain validate exits 0 on empty scaffolding, npx domain render generates docs/domain/index.md (empty contexts), npx domain search anything returns 0 results gracefully, .gitignore correctly excludes docs/domain/ + .domain-pack/ + node_modules/ + dist/. All Copilot artifacts (copilot-instructions.md, 3 prompts, skill) are present and well-formed.","status":"closed","priority":3,"issue_type":"task","owner":"kaanhakan2005@gmail.com","created_at":"2026-02-20T13:39:45.972315+03:00","created_by":"Kaan Akın","updated_at":"2026-02-20T17:28:59.060181+03:00","closed_at":"2026-02-20T17:28:59.060181+03:00","close_reason":"Closed","dependencies":[{"issue_id":"domain-knowledge-kit-hin.13","depends_on_id":"domain-knowledge-kit-hin","type":"parent-child","created_at":"2026-02-20T13:39:45.973602+03:00","created_by":"Kaan Akın"},{"issue_id":"domain-knowledge-kit-hin.13","depends_on_id":"domain-knowledge-kit-hin.10","type":"blocks","created_at":"2026-02-20T13:40:48.262415+03:00","created_by":"Kaan Akın"},{"issue_id":"domain-knowledge-kit-hin.13","depends_on_id":"domain-knowledge-kit-hin.11","type":"blocks","created_at":"2026-02-20T13:40:51.550216+03:00","created_by":"Kaan Akın"}]}
{"id":"domain-knowledge-kit-hin.2","title":"Directory scaffolding: domain/, docs/, tools/","description":"Create canonical directory structure: domain/contexts/ (.gitkeep), domain/actors.yml (actors: []), domain/index.yml (contexts: [], flows: []), docs/adr/ (.gitkeep + README.md explaining ADR format), docs/domain/ (.gitignored, generated), .github/prompts/, .github/skills/domain-knowledge/, tools/domain-pack/schema/, tools/domain-pack/templates/. Keep existing .github/agents/ untouched.","status":"closed","priority":1,"issue_type":"task","owner":"kaanhakan2005@gmail.com","created_at":"2026-02-20T13:38:25.236861+03:00","created_by":"Kaan Akın","updated_at":"2026-02-20T13:57:13.206407+03:00","closed_at":"2026-02-20T13:57:13.206407+03:00","close_reason":"Closed","dependencies":[{"issue_id":"domain-knowledge-kit-hin.2","depends_on_id":"domain-knowledge-kit-hin","type":"parent-child","created_at":"2026-02-20T13:38:25.237975+03:00","created_by":"Kaan Akın"},{"issue_id":"domain-knowledge-kit-hin.2","depends_on_id":"domain-knowledge-kit-hin.1","type":"blocks","created_at":"2026-02-20T13:39:51.025394+03:00","created_by":"Kaan Akın"}]}
{"id":"domain-knowledge-kit-hin.3","title":"JSON Schemas for YAML validation","description":"Create JSON Schema files in tools/domain-pack/schema/: context.schema.json, glossary.schema.json, actors.schema.json, event.schema.json, command.schema.json, policy.schema.json, aggregate.schema.json, read-model.schema.json, adr-frontmatter.schema.json, index.schema.json. Enforce stable id format (context.name for domain items, adr-NNN for ADRs), required fields per proposal section 4.","status":"closed","priority":2,"issue_type":"task","owner":"kaanhakan2005@gmail.com","created_at":"2026-02-20T13:38:31.704138+03:00","created_by":"Kaan Akın","updated_at":"2026-02-20T14:27:39.561297+03:00","closed_at":"2026-02-20T14:27:39.561297+03:00","close_reason":"Closed","dependencies":[{"issue_id":"domain-knowledge-kit-hin.3","depends_on_id":"domain-knowledge-kit-hin","type":"parent-child","created_at":"2026-02-20T13:38:31.705473+03:00","created_by":"Kaan Akın"},{"issue_id":"domain-knowledge-kit-hin.3","depends_on_id":"domain-knowledge-kit-hin.2","type":"blocks","created_at":"2026-02-20T13:39:58.719264+03:00","created_by":"Kaan Akın"}]}
{"id":"domain-knowledge-kit-hin.4","title":"TypeScript types and interfaces","description":"Create src/types/domain.ts with TypeScript interfaces for all domain item types: DomainContext, GlossaryEntry, Actor, DomainEvent, Command, Policy, Aggregate, ReadModel, AdrRecord, DomainModel (container). Create src/types/index.ts with SearchIndexRecord type. All types must align with the JSON Schemas from step 3.","status":"closed","priority":2,"issue_type":"task","owner":"kaanhakan2005@gmail.com","created_at":"2026-02-20T13:38:37.071542+03:00","created_by":"Kaan Akın","updated_at":"2026-02-20T14:32:06.496148+03:00","closed_at":"2026-02-20T14:32:06.496148+03:00","close_reason":"Closed","dependencies":[{"issue_id":"domain-knowledge-kit-hin.4","depends_on_id":"domain-knowledge-kit-hin","type":"parent-child","created_at":"2026-02-20T13:38:37.072297+03:00","created_by":"Kaan Akın"},{"issue_id":"domain-knowledge-kit-hin.4","depends_on_id":"domain-knowledge-kit-hin.2","type":"blocks","created_at":"2026-02-20T13:39:58.807446+03:00","created_by":"Kaan Akın"}]}
{"id":"domain-knowledge-kit-hin.5","title":"Core: Loader (YAML + ADR parser)","description":"Implement src/core/loader.ts: recursively walk domain/contexts/*/ to discover context dirs, parse context.yml, glossary.yml, event/command/policy/aggregate/read-model YAML files. Parse root actors.yml and index.yml. Implement src/utils/adr-parser.ts: parse docs/adr/*.md frontmatter (YAML between --- markers) for ADR records. Return typed DomainModel object with all items keyed by ID. Also create src/utils/paths.ts (repo-relative path resolution) and src/utils/yaml.ts (YAML parse/stringify helpers).","status":"closed","priority":2,"issue_type":"task","owner":"kaanhakan2005@gmail.com","created_at":"2026-02-20T13:38:44.644596+03:00","created_by":"Kaan Akın","updated_at":"2026-02-20T14:43:23.07906+03:00","closed_at":"2026-02-20T14:43:23.07906+03:00","close_reason":"Closed","dependencies":[{"issue_id":"domain-knowledge-kit-hin.5","depends_on_id":"domain-knowledge-kit-hin","type":"parent-child","created_at":"2026-02-20T13:38:44.6455+03:00","created_by":"Kaan Akın"},{"issue_id":"domain-knowledge-kit-hin.5","depends_on_id":"domain-knowledge-kit-hin.3","type":"blocks","created_at":"2026-02-20T13:40:14.831973+03:00","created_by":"Kaan Akın"},{"issue_id":"domain-knowledge-kit-hin.5","depends_on_id":"domain-knowledge-kit-hin.4","type":"blocks","created_at":"2026-02-20T13:40:18.086415+03:00","created_by":"Kaan Akın"}]}
{"id":"domain-knowledge-kit-hin.6","title":"Core: Validator (schema + cross-ref)","description":"Implement src/core/validator.ts: validate each YAML file against its JSON Schema (via ajv), ensure all IDs globally unique, all context references valid, all related/produces/handles/emits references resolve, all decisions references (adr-NNN) resolve to ADR files, all ADR domainRefs resolve to domain items. Configurable warning for events/commands without examples. Output: errors (blocking, exit 1) and warnings (non-blocking).","status":"closed","priority":2,"issue_type":"task","owner":"kaanhakan2005@gmail.com","created_at":"2026-02-20T13:38:51.197978+03:00","created_by":"Kaan Akın","updated_at":"2026-02-20T15:04:37.824697+03:00","closed_at":"2026-02-20T15:04:37.824697+03:00","close_reason":"Closed","dependencies":[{"issue_id":"domain-knowledge-kit-hin.6","depends_on_id":"domain-knowledge-kit-hin","type":"parent-child","created_at":"2026-02-20T13:38:51.198969+03:00","created_by":"Kaan Akın"},{"issue_id":"domain-knowledge-kit-hin.6","depends_on_id":"domain-knowledge-kit-hin.5","type":"blocks","created_at":"2026-02-20T13:40:21.277835+03:00","created_by":"Kaan Akın"}]}
{"id":"domain-knowledge-kit-hin.7","title":"Core: Domain graph (adjacency list)","description":"Implement src/core/graph.ts: build an adjacency-list graph from DomainModel. Nodes = any domain item (event, command, policy, aggregate, read-model, actor, ADR). Edges from related, produces, handles, emits, derivedFrom, when/then (policies), decisions/domainRefs. Expose getRelated(id, depth) returning set of related item IDs at given traversal depth. Used by search (graph expansion) and domain related command.","status":"closed","priority":2,"issue_type":"task","owner":"kaanhakan2005@gmail.com","created_at":"2026-02-20T13:38:57.873094+03:00","created_by":"Kaan Akın","updated_at":"2026-02-20T15:11:32.577643+03:00","closed_at":"2026-02-20T15:11:32.577643+03:00","close_reason":"Closed","dependencies":[{"issue_id":"domain-knowledge-kit-hin.7","depends_on_id":"domain-knowledge-kit-hin","type":"parent-child","created_at":"2026-02-20T13:38:57.874207+03:00","created_by":"Kaan Akın"},{"issue_id":"domain-knowledge-kit-hin.7","depends_on_id":"domain-knowledge-kit-hin.5","type":"blocks","created_at":"2026-02-20T13:40:24.793665+03:00","created_by":"Kaan Akın"}]}
{"id":"domain-knowledge-kit-hin.8","title":"Core: SQLite FTS5 indexer + searcher","description":"Implement src/core/indexer.ts: create/rebuild SQLite DB at .domain-pack/index.db with FTS5 virtual table domain_fts(id, type, context, name, tags, text, relations, adrRefs). Text column = concatenation of description, when/intent, invariants, examples, glossary terms+synonyms. Idempotent rebuild. Implement src/core/searcher.ts: accept query + optional filters (context, type, tag), FTS5 MATCH query, boost scoring (exact ID, name, tag, glossary), post-FTS filters, graph expansion for top-N results, include linked ADRs. Return ranked list of {id, type, context, name, excerpt, score, relatedIds, adrIds}.","status":"closed","priority":2,"issue_type":"task","owner":"kaanhakan2005@gmail.com","created_at":"2026-02-20T13:39:07.439413+03:00","created_by":"Kaan Akın","updated_at":"2026-02-20T15:17:04.49546+03:00","closed_at":"2026-02-20T15:17:04.49546+03:00","close_reason":"Closed","dependencies":[{"issue_id":"domain-knowledge-kit-hin.8","depends_on_id":"domain-knowledge-kit-hin","type":"parent-child","created_at":"2026-02-20T13:39:07.440333+03:00","created_by":"Kaan Akın"},{"issue_id":"domain-knowledge-kit-hin.8","depends_on_id":"domain-knowledge-kit-hin.7","type":"blocks","created_at":"2026-02-20T13:40:28.034717+03:00","created_by":"Kaan Akın"}]}
{"id":"domain-knowledge-kit-hin.9","title":"Core: Renderer (Handlebars templates)","description":"Implement src/core/renderer.ts: load Handlebars templates from tools/domain-pack/templates/, render to docs/domain/. Create templates: index.md.hbs (top-level domain index with contexts, glossary index, key flows), context.md.hbs (per-context: overview, glossary, events, commands, policies, aggregates, read-models, linked ADRs), item.md.hbs (per-item: summary, meaning, rules/invariants, examples, relationships, ADRs). Ensure output dirs exist, write files, report count.","status":"closed","priority":2,"issue_type":"task","owner":"kaanhakan2005@gmail.com","created_at":"2026-02-20T13:39:15.188891+03:00","created_by":"Kaan Akın","updated_at":"2026-02-20T16:44:04.413284+03:00","closed_at":"2026-02-20T16:44:04.413284+03:00","close_reason":"Closed","dependencies":[{"issue_id":"domain-knowledge-kit-hin.9","depends_on_id":"domain-knowledge-kit-hin","type":"parent-child","created_at":"2026-02-20T13:39:15.189729+03:00","created_by":"Kaan Akın"},{"issue_id":"domain-knowledge-kit-hin.9","depends_on_id":"domain-knowledge-kit-hin.5","type":"blocks","created_at":"2026-02-20T13:40:31.452387+03:00","created_by":"Kaan Akın"}]}
{"id":"domain-knowledge-kit-iit","title":"Slice-Private Modules","description":"These 3 core modules become pipeline-private (no other slice imports them):","status":"tombstone","priority":2,"issue_type":"task","created_at":"2026-02-20T19:20:00.809708+03:00","updated_at":"2026-02-20T19:20:17.575891+03:00","deleted_at":"2026-02-20T19:20:17.575891+03:00","deleted_by":"batch delete","delete_reason":"batch delete","original_type":"task"}
{"id":"domain-knowledge-kit-iji","title":"Vertical Slice Architecture Conversion","description":"Convert the current layered architecture (commands/ → core/ → types/ → utils/) into 3 vertical feature slices (query, adr, pipeline) plus a shared infrastructure module.\n\n## Motivation\n- The 'iterate all item types in context' pattern is duplicated in 5+ locations (graph.ts, validator.ts, renderer.ts, indexer.ts, list.ts)\n- Every command depends on core/loader.ts creating tight coupling through the layered structure\n- Tests are organized by layer rather than by feature, making it hard to reason about feature-level correctness\n- Adding a new domain item type requires touching 6+ files across different directories\n\n## Target Structure\n```\nsrc/\n  cli.ts                          # Slim entry point\n  shared/                         # Cross-cutting infrastructure\n    types/domain.ts               # DomainModel, all interfaces\n    types/index.ts                # SearchIndexRecord\n    loader.ts                     # loadDomainMo  -t epic   -p 1   -d Convert","status":"open","priority":1,"issue_type":"epic","owner":"kaanhakan2005@gmail.com","created_at":"2026-02-20T19:17:20.977863+03:00","created_by":"Kaan Akın","updated_at":"2026-02-20T19:17:20.977863+03:00"}
{"id":"domain-knowledge-kit-iji.1","title":"Extract item-visitor utility","description":"Create `src/shared/item-visitor.ts` that encapsulates the 'iterate over all item types in a context' pattern currently copy-pasted in 5+ locations.\n\n## Problem\nThe pattern of iterating `ctx.events ?? [] → ctx.commands ?? [] → ctx.policies ?? [] → ctx.aggregates ?? [] → ctx.read_models ?? [] → ctx.glossary ?? []` appears with slight variations in:\n- `src/core/graph.ts` — `DomainGraph.from()` factory method\n- `src/core/validator.ts` — 3 separate instances (schema validation, building lookup sets, cross-ref checks)\n- `src/core/renderer.ts` — `renderDocs()` and `collectContextAdrs()`\n- `src/core/indexer.ts` — `collectRows()`\n- `src/commands/list.ts` — `collectRows()`\n\nAdding a new domain item type (e.g., saga, projection) requires modifying 6+ files.\n\n## Solution\nCreate a generic visitor utility with two entry points:\n\n```typescript\ntype ItemType = 'event' | '  -t task   -p 2   --parent domain-knomo  -p 2  os  --par\ni  -d Create","status":"closed","priority":2,"issue_type":"task","owner":"kaanhakan2005@gmail.com","created_at":"2026-02-20T19:17:47.107819+03:00","created_by":"Kaan Akın","updated_at":"2026-02-20T19:34:57.912447+03:00","closed_at":"2026-02-20T19:34:57.912447+03:00","close_reason":"Closed","dependencies":[{"issue_id":"domain-knowledge-kit-iji.1","depends_on_id":"domain-knowledge-kit-iji","type":"parent-child","created_at":"2026-02-20T19:17:47.111321+03:00","created_by":"Kaan Akın"}]}
{"id":"domain-knowledge-kit-iji.10","title":"ADR: Document vertical slice architecture decision","description":"Create an Architecture Decision Record documenting the adoption of vertical slice architecture.\n\n## ADR Content\n\nTitle: Adopt Vertical Slice Architecture\nStatus: Accepted\n\nContext:\n- The codebase had a classic layered architecture (commands/ -\u003e core/ -\u003e types/ -\u003e utils/)\n- The \"iterate all item types in a context\" pattern was duplicated in 5+ locations across layers\n- Adding new domain item types required modifying 6+ files across different directories\n- Tests were organized by architectural layer, not by feature\n- Every command depended on the same loadDomainModel() creating uniform coupling regardless of command complexity\n\nDecision:\nAdopt a vertical slice architecture with 3 feature slices:\n- query: read-only exploration commands (list, show, search, related)\n- adr: ADR-specific commands (adr-show, adr-related)\n- pipeline: mutation/generation commands (validate, render) with their business logic (validator, renderer, indexer)\n\nShared infrastructure (loader, graph, types, utilities, item-visitor) lives in src/shared/.\n\nConsequences:\n- Each feature slice is self-contained with co-located commands, business logic, and tests\n- The item-visitor utility eliminates structural iteration duplication\n- New domain item types only require updating the visitor utility and the item type definitions\n- Tests are discoverable by navigating to the feature they test\n- Trade-off: shared/ still has high fan-in (loader used by all slices) but this reflects genuine shared domain needs\n\n## File Naming\n\nFollow existing ADR convention: docs/adr/adr-NNNN.md with YAML frontmatter including domain_refs for any related domain items.\n\n## Quality Gates\n\nAfter creating the ADR run:\n- npx tsx src/cli.ts validate\n- npx tsx src/cli.ts render\n\n## Acceptance Criteria\n\n- ADR file exists at docs/adr/adr-NNNN.md with correct YAML frontmatter\n- ADR passes validation (domain validate)\n- domain render succeeds and updates docs\n- ADR content accurately reflects the decisions made during the migration\n","status":"open","priority":3,"issue_type":"task","owner":"kaanhakan2005@gmail.com","created_at":"2026-02-20T19:23:04.325449+03:00","created_by":"Kaan Akın","updated_at":"2026-02-20T19:23:04.325449+03:00","dependencies":[{"issue_id":"domain-knowledge-kit-iji.10","depends_on_id":"domain-knowledge-kit-iji","type":"parent-child","created_at":"2026-02-20T19:23:04.327642+03:00","created_by":"Kaan Akın"},{"issue_id":"domain-knowledge-kit-iji.10","depends_on_id":"domain-knowledge-kit-iji.9","type":"blocks","created_at":"2026-02-20T19:23:04.330497+03:00","created_by":"Kaan Akın"}]}
{"id":"domain-knowledge-kit-iji.2","title":"Create src/shared/ and move cross-cutting modules","description":"Create the src/shared/ directory and relocate all cross-cutting infrastructure modules out of the layered directories.\n\n## Moves\n\n| From | To |\n|------|-----|\n| src/types/domain.ts | src/shared/types/domain.ts |\n| src/types/index.ts | src/shared/types/index.ts |\n| src/utils/paths.ts | src/shared/paths.ts |\n| src/utils/yaml.ts | src/shared/yaml.ts |\n| src/utils/adr-parser.ts | src/shared/adr-parser.ts |\n| src/core/loader.ts | src/shared/loader.ts |\n| src/core/graph.ts | src/shared/graph.ts |\n| src/shared/item-visitor.ts | (already created in previous ticket) |\n\n## Why These Stay Shared\n\n- loader.ts: All 8 commands call loadDomainModel()\n- graph.ts: Used by both query slice (search, related) and pipeline tests (indexer-searcher)\n- types/domain.ts: Every core module and 6/8 commands import types from here\n- paths.ts: Used by loader, renderer, indexer, searcher (4 core modules)\n- yaml.ts: Used by loader, adr-parser, show, adr-show\n- adr-parser.ts: Used by loader\n\n## Implementation Steps\n\n1. Create directory structure: src/shared/types/\n2. Move files using git mv to preserve history\n3. Update ALL internal imports across all consumers (commands, core modules, tests)\n4. Add barrel export at src/shared/index.ts re-exporting key functions/types\n5. Remove empty src/types/ and src/utils/ directories\n6. Verify no orphan imports remain\n\n## Import Update Scope\n\nEvery file that imports from ../types/, ../utils/, ../core/loader, or ../core/graph needs updating:\n- All 8 command files in src/commands/\n- src/core/validator.ts, src/core/renderer.ts, src/core/indexer.ts, src/core/searcher.ts\n- All test files in test/\n\n## Acceptance Criteria\n\n- src/shared/ directory exists with all moved files\n- src/shared/index.ts barrel export exists\n- src/types/ and src/utils/ directories are removed\n- All imports updated across the entire codebase\n- npm run build passes with zero errors\n- npm test passes\n- git log --follow shows history preserved for moved files\n","status":"closed","priority":2,"issue_type":"task","owner":"kaanhakan2005@gmail.com","created_at":"2026-02-20T19:22:14.623068+03:00","created_by":"Kaan Akın","updated_at":"2026-02-20T19:46:02.190477+03:00","closed_at":"2026-02-20T19:46:02.190477+03:00","close_reason":"Closed","dependencies":[{"issue_id":"domain-knowledge-kit-iji.2","depends_on_id":"domain-knowledge-kit-iji","type":"parent-child","created_at":"2026-02-20T19:22:14.625671+03:00","created_by":"Kaan Akın"},{"issue_id":"domain-knowledge-kit-iji.2","depends_on_id":"domain-knowledge-kit-iji.1","type":"blocks","created_at":"2026-02-20T19:22:14.627931+03:00","created_by":"Kaan Akın"}]}
{"id":"domain-knowledge-kit-iji.3","title":"Create query feature slice","description":"Create src/features/query/ and migrate all read-only query commands and query-specific business logic.\n\n## Moves\n\n| From | To |\n|------|-----|\n| src/commands/list.ts | src/features/query/commands/list.ts |\n| src/commands/show.ts | src/features/query/commands/show.ts |\n| src/commands/search.ts | src/features/query/commands/search.ts |\n| src/commands/related.ts | src/features/query/commands/related.ts |\n| src/core/searcher.ts | src/features/query/searcher.ts |\n\n## Rationale for Grouping\n\nThese 4 commands share a common pattern: they are all read-only operations that explore the domain model. list and show are simple lookups, while search and related add FTS5 and graph traversal respectively. The searcher.ts module is only used by the search command, making it slice-private.\n\n## Import Updates\n\nEach command will import shared modules from ../../shared/:\n- loader.ts for loadDomainModel()\n- types/domain.ts for DomainModel, DomainContext, etc.\n- graph.ts for DomainGraph (used by search and related)\n- yaml.ts for stringifyYaml (used by show)\n\nThe searcher imports from ../../shared/ for graph.ts and paths.ts.\n\n## Implementation Notes\n\n- Refactor remaining \"iterate all item types\" usage in list.ts to use item-visitor from shared\n- show.ts has a composite ID resolution function -- keep it in the command file (it is presentation logic)\n- search.ts conditionally builds a DomainGraph when --expand is used -- this stays in the command\n\n## Acceptance Criteria\n\n- All 4 commands (list, show, search, related) work identically via CLI\n- src/features/query/commands/ contains all 4 command files\n- src/features/query/searcher.ts exists\n- npm run build and npm test pass\n- No query-related files remain in src/commands/ or src/core/\n","status":"closed","priority":2,"issue_type":"task","owner":"kaanhakan2005@gmail.com","created_at":"2026-02-20T19:22:22.559937+03:00","created_by":"Kaan Akın","updated_at":"2026-02-20T19:53:07.218414+03:00","closed_at":"2026-02-20T19:53:07.218414+03:00","close_reason":"Closed","dependencies":[{"issue_id":"domain-knowledge-kit-iji.3","depends_on_id":"domain-knowledge-kit-iji","type":"parent-child","created_at":"2026-02-20T19:22:22.562423+03:00","created_by":"Kaan Akın"},{"issue_id":"domain-knowledge-kit-iji.3","depends_on_id":"domain-knowledge-kit-iji.2","type":"blocks","created_at":"2026-02-20T19:22:22.565246+03:00","created_by":"Kaan Akın"}]}
{"id":"domain-knowledge-kit-iji.4","title":"Create adr feature slice","description":"Create src/features/adr/ and migrate all ADR-related commands.\n\n## Moves\n\n| From | To |\n|------|-----|\n| src/commands/adr-show.ts | src/features/adr/commands/adr-show.ts |\n| src/commands/adr-related.ts | src/features/adr/commands/adr-related.ts |\n\n## Rationale\n\nThese are the simplest commands in the codebase. They only depend on:\n- loader.ts for loadDomainModel() (shared)\n- types/domain.ts for AdrRecord, DomainModel (shared)\n- yaml.ts for stringifyYaml (shared, adr-show only)\n\nNo slice-private business logic modules needed -- all logic is inline in the command handlers.\n\n## Implementation Notes\n\n- adr-show.ts looks up ADRs by ID from model.adrs map and prints YAML/JSON\n- adr-related.ts does bidirectional link resolution: finds domain items that reference an ADR (via adr_refs) and ADRs that reference domain items (via domain_refs)\n- The adr-related.ts command iterates all item types to check adr_refs -- refactor this to use item-visitor from shared\n\n## Acceptance Criteria\n\n- adr show and adr related CLI commands work identically to before\n- src/features/adr/commands/ contains both command files\n- npm run build and npm test pass\n- No ADR-related files remain in src/commands/\n","status":"closed","priority":2,"issue_type":"task","owner":"kaanhakan2005@gmail.com","created_at":"2026-02-20T19:22:28.98187+03:00","created_by":"Kaan Akın","updated_at":"2026-02-20T19:58:01.185705+03:00","closed_at":"2026-02-20T19:58:01.185705+03:00","close_reason":"Closed","dependencies":[{"issue_id":"domain-knowledge-kit-iji.4","depends_on_id":"domain-knowledge-kit-iji","type":"parent-child","created_at":"2026-02-20T19:22:28.9846+03:00","created_by":"Kaan Akın"},{"issue_id":"domain-knowledge-kit-iji.4","depends_on_id":"domain-knowledge-kit-iji.2","type":"blocks","created_at":"2026-02-20T19:22:28.987669+03:00","created_by":"Kaan Akın"}]}
{"id":"domain-knowledge-kit-iji.5","title":"Create pipeline feature slice","description":"Create src/features/pipeline/ and migrate all mutation/generation commands and their business logic.\n\n## Moves\n\n| From | To |\n|------|-----|\n| src/commands/validate.ts | src/features/pipeline/commands/validate.ts |\n| src/commands/render.ts | src/features/pipeline/commands/render.ts |\n| src/core/validator.ts | src/features/pipeline/validator.ts |\n| src/core/renderer.ts | src/features/pipeline/renderer.ts |\n| src/core/indexer.ts | src/features/pipeline/indexer.ts |\n\n## Rationale for Grouping\n\nThese commands are the only ones that write to disk:\n- validate performs JSON Schema + cross-reference validation (read-only but part of the build pipeline)\n- render orchestrates: load -\u003e validate -\u003e render docs -\u003e build search index\n\nThe render command already chains validator, renderer, and indexer, making them a natural cohesive unit. The validator is also used standalone by the validate command.\n\n## Slice-Private Modules\n\nThese 3 core modules become pipeline-private (no other slice imports them):\n- validator.ts: JSON Schema validation via ajv + cross-reference checks\n- renderer.ts: Handlebars template rendering to docs/domain/\n- indexer.ts: SQLite FTS5 index builder at .domain-pack/index.db\n\n## Item-Visitor Refactoring\n\nThe biggest wins from item-visitor are in this slice:\n- validator.ts has 3 instances of the iterate-all pattern (building lookup sets, duplicate checks, cross-ref checks)\n- indexer.ts has 1 instance in collectRows()\n- renderer.ts has 1 instance in renderDocs() plus collectContextAdrs()\n\nRefactor ALL of these to use item-visitor from shared.\n\n## CJS Interop Note\n\nvalidator.ts and indexer.ts use createRequire(import.meta.url) for ajv/ajv-formats and better-sqlite3 respectively. This pattern stays unchanged.\n\n## Acceptance Criteria\n\n- validate and render CLI commands work identically to before\n- src/features/pipeline/commands/ contains both command files\n- src/features/pipeline/ contains validator.ts, renderer.ts, indexer.ts\n- All \"iterate all item types\" patterns refactored to use item-visitor\n- npm run build and npm test pass\n- No pipeline-related files remain in src/commands/ or src/core/\n- src/commands/ and src/core/ directories are empty and can be removed\n","status":"closed","priority":2,"issue_type":"task","owner":"kaanhakan2005@gmail.com","created_at":"2026-02-20T19:22:33.996267+03:00","created_by":"Kaan Akın","updated_at":"2026-02-20T20:18:18.254584+03:00","closed_at":"2026-02-20T20:18:18.254584+03:00","close_reason":"Closed","dependencies":[{"issue_id":"domain-knowledge-kit-iji.5","depends_on_id":"domain-knowledge-kit-iji","type":"parent-child","created_at":"2026-02-20T19:22:33.999093+03:00","created_by":"Kaan Akın"},{"issue_id":"domain-knowledge-kit-iji.5","depends_on_id":"domain-knowledge-kit-iji.2","type":"blocks","created_at":"2026-02-20T19:22:34.001733+03:00","created_by":"Kaan Akın"}]}
{"id":"domain-knowledge-kit-iji.6","title":"Update CLI entry point and remove old directories","description":"Refactor src/cli.ts to import from the new feature slice locations and clean up old directories.\n\n## Current State (before this ticket)\n\nThe CLI imports all 8 register functions from ./commands/*.js\n\n## Target State\n\nImports change to:\n- ./features/query/commands/list.js, show.js, search.js, related.js\n- ./features/adr/commands/adr-show.js, adr-related.js\n- ./features/pipeline/commands/validate.js, render.js\n\n## Additional Changes\n\n1. Extract error formatting: Move formatCliError(), isYAMLException(), isNodeSystemError() helper functions to src/shared/errors.ts since they are presentation infrastructure, not feature logic\n2. Remove old empty directories: src/commands/, src/core/\n3. Consider feature barrel exports: Each slice could export a register(program) function from a barrel file, but explicit imports are fine if the team prefers clarity\n\n## Acceptance Criteria\n\n- All 8 CLI commands work: list, show, search, related, validate, render, adr show, adr related\n- src/commands/ directory no longer exists\n- src/core/ directory no longer exists\n- src/cli.ts imports only from ./features/ and ./shared/\n- formatCliError() moved to src/shared/errors.ts\n- npm run build and npm test pass\n","status":"closed","priority":2,"issue_type":"task","owner":"kaanhakan2005@gmail.com","created_at":"2026-02-20T19:22:40.083308+03:00","created_by":"Kaan Akın","updated_at":"2026-02-20T20:22:28.672024+03:00","closed_at":"2026-02-20T20:22:28.672024+03:00","close_reason":"Closed","dependencies":[{"issue_id":"domain-knowledge-kit-iji.6","depends_on_id":"domain-knowledge-kit-iji","type":"parent-child","created_at":"2026-02-20T19:22:40.085747+03:00","created_by":"Kaan Akın"},{"issue_id":"domain-knowledge-kit-iji.6","depends_on_id":"domain-knowledge-kit-iji.3","type":"blocks","created_at":"2026-02-20T19:22:40.088748+03:00","created_by":"Kaan Akın"},{"issue_id":"domain-knowledge-kit-iji.6","depends_on_id":"domain-knowledge-kit-iji.4","type":"blocks","created_at":"2026-02-20T19:22:40.091221+03:00","created_by":"Kaan Akın"},{"issue_id":"domain-knowledge-kit-iji.6","depends_on_id":"domain-knowledge-kit-iji.5","type":"blocks","created_at":"2026-02-20T19:22:40.093611+03:00","created_by":"Kaan Akın"}]}
{"id":"domain-knowledge-kit-iji.7","title":"Co-locate unit tests with feature slices","description":"Migrate unit/integration test files from the top-level test/ folder into co-located __tests__/ directories within their respective feature slices and shared module.\n\n## Test Migration Map\n\n| From | To | Rationale |\n|------|-----|-----------|\n| test/graph.ts | src/shared/__tests__/graph.test.ts | Graph is shared infrastructure |\n| test/indexer-searcher.ts | Split into two files (see below) | Indexer is pipeline, searcher is query |\n| test/loader.ts | src/shared/__tests__/loader.test.ts | Loader is shared |\n| test/validator.ts | src/features/pipeline/__tests__/validator.test.ts | Part of pipeline |\n| test/validate-schemas.ts | src/features/pipeline/__tests__/validate-schemas.test.ts | Part of pipeline |\n| test/renderer.ts | src/features/pipeline/__tests__/renderer.test.ts | Part of pipeline |\n| test/verify-collision-fix.ts | src/shared/__tests__/verify-collision-fix.test.ts | Tests graph/loader (shared) |\n| test/cli-integration.ts | Stays in test/ | Cross-cutting E2E test |\n\n## Splitting indexer-searcher.ts\n\nThe current test/indexer-searcher.ts tests both buildIndex() and search(). These need to be split:\n- Indexer tests move to pipeline slice: src/features/pipeline/__tests__/indexer.test.ts\n- Searcher tests move to query slice: src/features/query/__tests__/searcher.test.ts\n- Both may need a shared test helper for building a test index (since searcher tests need an index to query)\n\n## Test Script Update\n\nUpdate package.json test script to discover tests at new locations. Options:\n- Glob-based: tsx src/shared/__tests__/*.test.ts \u0026\u0026 tsx src/features/*/__tests__/*.test.ts \u0026\u0026 tsx test/*.ts\n- Or enumerate explicitly (current approach but with new paths)\n\n## Import Updates\n\nAll test files use relative imports to core modules. These need updating to point at new shared/feature locations.\n\n## Acceptance Criteria\n\n- npm test passes with all tests at new locations\n- Only test/cli-integration.ts remains in the top-level test/ folder\n- test/ directory only contains cli-integration.ts\n- indexer-searcher.ts successfully split into two independent test files\n- Test coverage unchanged (same number of assertions pass)\n","status":"closed","priority":2,"issue_type":"task","owner":"kaanhakan2005@gmail.com","created_at":"2026-02-20T19:22:45.523739+03:00","created_by":"Kaan Akın","updated_at":"2026-02-20T20:40:25.295504+03:00","closed_at":"2026-02-20T20:40:25.295504+03:00","close_reason":"Closed","dependencies":[{"issue_id":"domain-knowledge-kit-iji.7","depends_on_id":"domain-knowledge-kit-iji","type":"parent-child","created_at":"2026-02-20T19:22:45.526323+03:00","created_by":"Kaan Akın"},{"issue_id":"domain-knowledge-kit-iji.7","depends_on_id":"domain-knowledge-kit-iji.6","type":"blocks","created_at":"2026-02-20T19:22:45.528735+03:00","created_by":"Kaan Akın"}]}
{"id":"domain-knowledge-kit-iji.8","title":"Update CLI integration tests for new structure","description":"Verify and update test/cli-integration.ts after the vertical slice restructuring.\n\n## Context\n\ntest/cli-integration.ts (629 lines) is the end-to-end CLI test suite. It spawns the actual CLI as a child process via npx tsx src/cli.ts. Since the CLI entry point (src/cli.ts) is the only thing it references, the structural changes underneath should be transparent -- but this needs verification.\n\n## Test Groups to Verify (10 groups)\n\n1. validate: ok, fail, json output\n2. show: ok, unknown ID, json output, actor lookup\n3. search: no-index error, after render\n4. related: ok, unknown ID, json output\n5. list: unfiltered, context filter, type filter, combined, json, no-match\n6. adr show: ok, unknown, json\n7. adr related: ok, unknown, json, reverse lookup\n8. render: ok\n9. error paths: malformed YAML, empty domain\n10. verify-collision-fix: glossary/aggregate ID collision\n\n## What Might Break\n\n- If the CLI parseAsync() call or error formatting changed\n- If command names or option flags were inadvertently altered\n- If output formatting changed (tests assert on stdout content)\n\n## Tasks\n\n1. Run test/cli-integration.ts after all slice migrations\n2. Fix any broken assertions\n3. Add a smoke test that verifies all 8 commands are registered (e.g., --help output contains all command names)\n4. Verify error-path tests (malformed YAML, ENOENT) still trigger correct error messages after formatCliError() was moved to shared/errors.ts\n\n## Acceptance Criteria\n\n- All 10 test groups in cli-integration.ts pass\n- No regressions in error-path tests\n- New smoke test verifying command registration exists\n- npm test passes as a whole\n","status":"closed","priority":2,"issue_type":"task","owner":"kaanhakan2005@gmail.com","created_at":"2026-02-20T19:22:52.933745+03:00","created_by":"Kaan Akın","updated_at":"2026-02-20T20:48:41.047965+03:00","closed_at":"2026-02-20T20:48:41.047965+03:00","close_reason":"Closed","dependencies":[{"issue_id":"domain-knowledge-kit-iji.8","depends_on_id":"domain-knowledge-kit-iji","type":"parent-child","created_at":"2026-02-20T19:22:52.936655+03:00","created_by":"Kaan Akın"},{"issue_id":"domain-knowledge-kit-iji.8","depends_on_id":"domain-knowledge-kit-iji.6","type":"blocks","created_at":"2026-02-20T19:22:52.938988+03:00","created_by":"Kaan Akın"}]}
{"id":"domain-knowledge-kit-iji.9","title":"Final cleanup and build verification","description":"Final cleanup pass after all migrations are complete. Remove orphan directories, verify build output, and update documentation.\n\n## Cleanup Tasks\n\n1. Remove empty directories: Verify and remove src/commands/, src/core/, src/types/, src/utils/ if they still exist\n2. Check for stale files: git status should show no untracked old files\n3. Verify tsconfig.json: rootDir src still works since all code remains under src/. No changes needed unless path mappings were considered\n4. Verify dist/ output: npm run build should produce correct dist/ layout matching the new src/ structure\n\n## Build Verification\n\nRun these commands and verify all pass:\n- npm run build\n- npm test\n- npx tsx src/cli.ts validate\n- npx tsx src/cli.ts render\n\n## Documentation Updates\n\nUpdate README.md to reflect the new project structure:\n- Replace the old folder structure diagram with the new vertical slice layout\n- Document the feature slice organization: query, adr, pipeline\n- Explain the shared/ module purpose\n- Update any contributing or architecture sections\n\n## Package Verification\n\n- Verify package.json bin entry still works: dist/cli.js should be the compiled entry point\n- Verify files array in package.json includes the right paths for the published package\n- Test npx domain-knowledge-kit --help after building\n\n## Acceptance Criteria\n\n- No orphan empty directories remain under src/\n- npm run build produces complete dist/ with all feature slices\n- npm test passes\n- domain validate and domain render succeed\n- README.md documents the new architecture\n- Published package file list (files in package.json) is correct\n","status":"closed","priority":2,"issue_type":"task","owner":"kaanhakan2005@gmail.com","created_at":"2026-02-20T19:22:58.983532+03:00","created_by":"Kaan Akın","updated_at":"2026-02-20T20:56:59.755191+03:00","closed_at":"2026-02-20T20:56:59.755191+03:00","close_reason":"Closed","dependencies":[{"issue_id":"domain-knowledge-kit-iji.9","depends_on_id":"domain-knowledge-kit-iji","type":"parent-child","created_at":"2026-02-20T19:22:58.986628+03:00","created_by":"Kaan Akın"},{"issue_id":"domain-knowledge-kit-iji.9","depends_on_id":"domain-knowledge-kit-iji.7","type":"blocks","created_at":"2026-02-20T19:22:58.989658+03:00","created_by":"Kaan Akın"},{"issue_id":"domain-knowledge-kit-iji.9","depends_on_id":"domain-knowledge-kit-iji.8","type":"blocks","created_at":"2026-02-20T19:22:58.992311+03:00","created_by":"Kaan Akın"}]}
{"id":"domain-knowledge-kit-ing","title":"Acceptance Criteria","description":"- All 8 CLI commands work: `list`, `show`, `search`, `related`, `validate`, `render`, `adr show`, `adr related`","status":"tombstone","priority":2,"issue_type":"task","created_at":"2026-02-20T19:20:00.855851+03:00","updated_at":"2026-02-20T19:20:17.575891+03:00","deleted_at":"2026-02-20T19:20:17.575891+03:00","deleted_by":"batch delete","delete_reason":"batch delete","original_type":"task"}
{"id":"domain-knowledge-kit-k7i","title":"Moves","description":"| From | To |","status":"tombstone","priority":2,"issue_type":"task","created_at":"2026-02-20T19:20:00.711865+03:00","updated_at":"2026-02-20T19:20:17.575891+03:00","deleted_at":"2026-02-20T19:20:17.575891+03:00","deleted_by":"batch delete","delete_reason":"batch delete","original_type":"task"}
{"id":"domain-knowledge-kit-kp0","title":"Splitting indexer-searcher.ts","description":"The current `test/indexer-searcher.ts` tests both `buildIndex()` and `search()`. These need to be split:","status":"tombstone","priority":2,"issue_type":"task","created_at":"2026-02-20T19:20:00.870056+03:00","updated_at":"2026-02-20T19:20:17.575891+03:00","deleted_at":"2026-02-20T19:20:17.575891+03:00","deleted_by":"batch delete","delete_reason":"batch delete","original_type":"task"}
{"id":"domain-knowledge-kit-l60","title":"Rationale for Grouping","description":"These commands are the only ones that write to disk:","status":"tombstone","priority":2,"issue_type":"task","created_at":"2026-02-20T19:20:00.804159+03:00","updated_at":"2026-02-20T19:20:17.575891+03:00","deleted_at":"2026-02-20T19:20:17.575891+03:00","deleted_by":"batch delete","delete_reason":"batch delete","original_type":"task"}
{"id":"domain-knowledge-kit-lo8","title":"Import Updates","description":"Commands import from `../../shared/` for loader, types.","status":"tombstone","priority":2,"issue_type":"task","created_at":"2026-02-20T19:20:00.816185+03:00","updated_at":"2026-02-20T19:20:17.575891+03:00","deleted_at":"2026-02-20T19:20:17.575891+03:00","deleted_by":"batch delete","delete_reason":"batch delete","original_type":"task"}
{"id":"domain-knowledge-kit-n9v","title":"Context","description":"`test/cli-integration.ts` (629 lines) is the end-to-end CLI test suite. It spawns the actual CLI as a child process via `npx tsx src/cli.ts`. Since the CLI entry point (`src/cli.ts`) is the only thing it references, the structural changes underneath should be transparent -- but this needs verification.","status":"tombstone","priority":2,"issue_type":"task","created_at":"2026-02-20T19:20:00.901771+03:00","updated_at":"2026-02-20T19:20:17.575891+03:00","deleted_at":"2026-02-20T19:20:17.575891+03:00","deleted_by":"batch delete","delete_reason":"batch delete","original_type":"task"}
{"id":"domain-knowledge-kit-nft","title":"Add --json output flag to CLI commands","description":"All CLI commands (list, show, search, related, adr show, adr related) output only human-readable text. For CI, scripting, and Copilot tool integration, machine-readable JSON output would be valuable. Add a --json flag to each command that outputs structured JSON instead of formatted text.","status":"closed","priority":2,"issue_type":"task","owner":"kaanhakan2005@gmail.com","created_at":"2026-02-20T17:48:08.64178+03:00","created_by":"Kaan Akın","updated_at":"2026-02-20T18:28:34.275541+03:00","closed_at":"2026-02-20T18:28:34.275541+03:00","close_reason":"Duplicate of t8l.9."}
{"id":"domain-knowledge-kit-nm2","title":"Implementation Notes","description":"- Refactor remaining \"iterate all item types\" usage in `list.ts` to use `item-visitor` from shared","status":"tombstone","priority":2,"issue_type":"task","created_at":"2026-02-20T19:20:00.761532+03:00","updated_at":"2026-02-20T19:20:17.575891+03:00","deleted_at":"2026-02-20T19:20:17.575891+03:00","deleted_by":"batch delete","delete_reason":"batch delete","original_type":"task"}
{"id":"domain-knowledge-kit-pgg","title":"Why These Stay Shared","description":"- **loader.ts** -- All 8 commands call `loadDomainModel()`","status":"tombstone","priority":2,"issue_type":"task","created_at":"2026-02-20T19:20:00.718433+03:00","updated_at":"2026-02-20T19:20:17.575891+03:00","deleted_at":"2026-02-20T19:20:17.575891+03:00","deleted_by":"batch delete","delete_reason":"batch delete","original_type":"task"}
{"id":"domain-knowledge-kit-q46","title":"Acceptance Criteria","description":"- All 10 test groups in `cli-integration.ts` pass","status":"tombstone","priority":2,"issue_type":"task","created_at":"2026-02-20T19:20:00.991833+03:00","updated_at":"2026-02-20T19:20:17.575891+03:00","deleted_at":"2026-02-20T19:20:17.575891+03:00","deleted_by":"batch delete","delete_reason":"batch delete","original_type":"task"}
{"id":"domain-knowledge-kit-qqf","title":"PM Investigate: Duplicate of t8l.9 - json output flag (re: domain-knowledge-kit-nft)","status":"closed","priority":2,"issue_type":"task","owner":"kaanhakan2005@gmail.com","created_at":"2026-02-20T18:12:57.105747+03:00","created_by":"Kaan Akın","updated_at":"2026-02-20T18:28:34.152036+03:00","closed_at":"2026-02-20T18:28:34.152036+03:00","close_reason":"Duplicate investigation; see t8l.9.","labels":["pm_investigate"]}
{"id":"domain-knowledge-kit-sg8","title":"Item-Visitor Refactoring","description":"The biggest wins from item-visitor are in this slice:","status":"tombstone","priority":2,"issue_type":"task","created_at":"2026-02-20T19:20:00.82161+03:00","updated_at":"2026-02-20T19:20:17.575891+03:00","deleted_at":"2026-02-20T19:20:17.575891+03:00","deleted_by":"batch delete","delete_reason":"batch delete","original_type":"task"}
{"id":"domain-knowledge-kit-slx","title":"Tasks","description":"1. Run `test/cli-integration.ts` after all slice migrations","status":"tombstone","priority":2,"issue_type":"task","created_at":"2026-02-20T19:20:00.979725+03:00","updated_at":"2026-02-20T19:20:17.575891+03:00","deleted_at":"2026-02-20T19:20:17.575891+03:00","deleted_by":"batch delete","delete_reason":"batch delete","original_type":"task"}
{"id":"domain-knowledge-kit-t0l","title":"CJS Interop","description":"`validator.ts`, `indexer.ts` use `createRequire(import.meta.url)` for `ajv`/`ajv-formats` and `better-sqlite3` respectively. This pattern stays unchanged.","status":"tombstone","priority":2,"issue_type":"task","created_at":"2026-02-20T19:20:00.826978+03:00","updated_at":"2026-02-20T19:20:17.575891+03:00","deleted_at":"2026-02-20T19:20:17.575891+03:00","deleted_by":"batch delete","delete_reason":"batch delete","original_type":"task"}
{"id":"domain-knowledge-kit-t8l","title":"Post-bootstrap hardening: bugs, test script, packaging, robustness, and test coverage","description":"Follow-up work identified after completing the bootstrap epic (domain-knowledge-kit-hin). Covers bug fixes, missing npm test script, CLI error handling, packaging for distribution, stale doc cleanup, and test coverage gaps. All child issues are concrete, actionable, and grounded in code review of the current codebase.","notes":"## Preflight\n- Classification: Applicable + Large/Complex (already-decomposed epic)\n- This is an already-decomposed epic with 5 open children: t8l.7, t8l.8, t8l.9, t8l.10, t8l.11\n- 6 children already closed: t8l.1, t8l.2, t8l.3, t8l.4, t8l.5, t8l.6\n- Duplicate standalone issues flagged for PM investigation: 3eu (=t8l.8), nft (=t8l.9), xto (=t8l.7), v37 (=t8l.10)\n\n### Decomposed Into Subtickets\n- Existing subtickets: t8l.7, t8l.8, t8l.9, t8l.10, t8l.11 (open)\n- Duplicate standalone issues exist: 3eu (=t8l.8), nft (=t8l.9), xto (=t8l.7), v37 (=t8l.10)\n- Parent should be worked via subtickets only","status":"closed","priority":2,"issue_type":"epic","owner":"kaanhakan2005@gmail.com","created_at":"2026-02-20T17:37:25.862979+03:00","created_by":"Kaan Akın","updated_at":"2026-02-20T18:52:26.246441+03:00","closed_at":"2026-02-20T18:52:26.246441+03:00","close_reason":"Closed"}
{"id":"domain-knowledge-kit-t8l.1","title":"Bug: search error message says 'Run index first' but correct command is 'render'","description":"In src/core/searcher.ts line 135, the error message when the search index is missing says: 'Search index not found at ${dbPath}. Run index first.' But there is no standalone 'index' command — the correct command is 'domain-knowledge-kit render' (which validates, renders docs, AND rebuilds the search index). This will confuse any user who encounters the error.","notes":"## Preflight\\n- Goal: Fix incorrect error message referencing non-existent 'index' command\\n- Reality: Already fixed in commit fbcc291 (fix: quality hardening). Error message in src/core/searcher.ts line 135 already reads \"Run 'render' first.\"\\n- No other incorrect references to 'index' command found in codebase\\n- E2E test: skipped — this is a string-only fix already applied, no behavior change\\n\\n## Implementation Summary\\nNo code changes needed. The fix was already applied in commit fbcc291 as part of the quality hardening batch.","status":"closed","priority":0,"issue_type":"bug","owner":"kaanhakan2005@gmail.com","estimated_minutes":5,"created_at":"2026-02-20T17:37:36.91467+03:00","created_by":"Kaan Akın","updated_at":"2026-02-20T17:52:32.624694+03:00","closed_at":"2026-02-20T17:52:32.624694+03:00","close_reason":"Closed","dependencies":[{"issue_id":"domain-knowledge-kit-t8l.1","depends_on_id":"domain-knowledge-kit-t8l","type":"parent-child","created_at":"2026-02-20T17:37:36.916414+03:00","created_by":"Kaan Akın"}]}
{"id":"domain-knowledge-kit-t8l.10","title":"Add CLI integration tests for command wiring and error paths","description":"All existing tests are unit tests against core modules (loader, validator, graph, indexer/searcher, renderer). There are no tests that exercise the CLI commands (src/commands/*.ts) through their Commander action handlers. This means command registration, option parsing, output formatting, and process.exit(1) error paths are untested.","notes":"Key gaps to cover: (1) validate command exits 1 on errors and 0 on success, (2) show command exits 1 for unknown IDs, (3) search command with no index shows helpful error, (4) related command exits 1 for unknown nodes, (5) list with --context and --type filters produces correct output, (6) adr show/related for unknown IDs. Implementation: Can use child_process.execFileSync to run the CLI and assert stdout/stderr/exit code. Use temp directories with --root flag.","status":"closed","priority":2,"issue_type":"task","owner":"kaanhakan2005@gmail.com","estimated_minutes":60,"created_at":"2026-02-20T17:39:17.607963+03:00","created_by":"Kaan Akın","updated_at":"2026-02-20T18:37:43.513024+03:00","closed_at":"2026-02-20T18:37:43.513024+03:00","close_reason":"Closed","dependencies":[{"issue_id":"domain-knowledge-kit-t8l.10","depends_on_id":"domain-knowledge-kit-t8l","type":"parent-child","created_at":"2026-02-20T17:39:17.609782+03:00","created_by":"Kaan Akın"}]}
{"id":"domain-knowledge-kit-t8l.11","title":"Index ADR body content for full-text search, not just frontmatter","description":"The FTS5 indexer (src/core/indexer.ts) only indexes ADR frontmatter (title, status, deciders). The actual Markdown body of ADRs (Context, Decision, Consequences sections) is not included in the search text column. This means searching for terms discussed in ADR decisions won't find the relevant ADRs.","notes":"Implementation: Extend parseAdrFile in src/utils/adr-parser.ts to also return the body text (everything after the closing ---). Add a body field to AdrRecord or return it separately. In the indexer, concatenate the body text into the text column for ADR rows. Consider stripping Markdown formatting (headers, links) before indexing for cleaner search results.","status":"closed","priority":3,"issue_type":"feature","owner":"kaanhakan2005@gmail.com","estimated_minutes":45,"created_at":"2026-02-20T17:39:28.418021+03:00","created_by":"Kaan Akın","updated_at":"2026-02-20T18:46:59.07817+03:00","closed_at":"2026-02-20T18:46:59.07817+03:00","close_reason":"Closed","dependencies":[{"issue_id":"domain-knowledge-kit-t8l.11","depends_on_id":"domain-knowledge-kit-t8l","type":"parent-child","created_at":"2026-02-20T17:39:28.42053+03:00","created_by":"Kaan Akın"}]}
{"id":"domain-knowledge-kit-t8l.2","title":"Bug: graph node namespace collision between glossary terms and aggregates with same name","description":"In src/core/graph.ts, DomainGraph.from() uses scopedId(ctxName, name) for both glossary terms and aggregates. When a glossary term and an aggregate share a name (e.g. Order in the ordering context), they get the same id ordering.Order. Since ensureNode() skips creation if the node already exists, whichever is processed first wins the kind label. Currently glossary is processed before aggregates, so the Order aggregate gets kind=glossary in the graph.","notes":"Root cause: graph.ts ensureNode() first-call-wins semantics. Fix options: (1) prefix glossary ids, (2) allow ensureNode to upgrade kind, (3) store multi-kind, (4) validation warning on name collision with glossary.","status":"closed","priority":1,"issue_type":"bug","owner":"kaanhakan2005@gmail.com","estimated_minutes":30,"created_at":"2026-02-20T17:38:00.743026+03:00","created_by":"Kaan Akın","updated_at":"2026-02-20T17:39:40.674772+03:00","closed_at":"2026-02-20T17:39:40.674772+03:00","close_reason":"Duplicate of domain-knowledge-kit-t8l.3 (created twice due to shell escaping issue)","dependencies":[{"issue_id":"domain-knowledge-kit-t8l.2","depends_on_id":"domain-knowledge-kit-t8l","type":"parent-child","created_at":"2026-02-20T17:38:00.745411+03:00","created_by":"Kaan Akın"}]}
{"id":"domain-knowledge-kit-t8l.3","title":"Bug: graph node namespace collision between glossary terms and aggregates","description":"In graph.ts, DomainGraph.from() uses scopedId for both glossary terms and aggregates. When they share a name (e.g. Order), the first ensureNode call wins the kind label. Glossary is processed first, so aggregates get mislabeled as glossary.","notes":"Implementation: Modified ensureNode in graph.ts to update kind when existing node is glossary and new kind is structural. Verified: all 210 tests pass, quality gates pass, collision fix confirmed by dedicated E2E test.","status":"closed","priority":1,"issue_type":"bug","owner":"kaanhakan2005@gmail.com","estimated_minutes":30,"created_at":"2026-02-20T17:38:06.980891+03:00","created_by":"Kaan Akın","updated_at":"2026-02-20T17:57:41.666484+03:00","closed_at":"2026-02-20T17:57:41.666484+03:00","close_reason":"Closed","dependencies":[{"issue_id":"domain-knowledge-kit-t8l.3","depends_on_id":"domain-knowledge-kit-t8l","type":"parent-child","created_at":"2026-02-20T17:38:06.982512+03:00","created_by":"Kaan Akın"}]}
{"id":"domain-knowledge-kit-t8l.4","title":"Add npm test script to package.json","description":"package.json has no test script despite 6 test files in test/. Users and CI cannot run npm test. Tests currently require manually running npx tsx test/\u003cfile\u003e.ts for each file.","notes":"Implementation: Added verify-collision-fix.ts to the test script chain in package.json.\\nVerification: npm test runs all 7 test files, all pass, exit code 0.\\nThe test script was partially implemented in fbcc291 (6 of 7 files); this completes it.","status":"closed","priority":1,"issue_type":"task","owner":"kaanhakan2005@gmail.com","estimated_minutes":15,"created_at":"2026-02-20T17:38:15.09825+03:00","created_by":"Kaan Akın","updated_at":"2026-02-20T18:00:14.542843+03:00","closed_at":"2026-02-20T18:00:14.542843+03:00","close_reason":"Closed","dependencies":[{"issue_id":"domain-knowledge-kit-t8l.4","depends_on_id":"domain-knowledge-kit-t8l","type":"parent-child","created_at":"2026-02-20T17:38:15.10038+03:00","created_by":"Kaan Akın"}]}
{"id":"domain-knowledge-kit-t8l.5","title":"Add global CLI error handling for user-friendly error messages","description":"CLI commands call loadDomainModel() which can throw on malformed YAML, missing files, or permission errors. These exceptions bubble up as raw stack traces. The CLI needs a top-level try/catch or Commander error handler that prints clean error messages instead of stack traces.","notes":"Preflight:\n- Goal: Catch errors (YAML parse, missing files, permission) from loadDomainModel() and command handlers, print user-friendly messages instead of raw stack traces\n- Sizing: Small/Contained\n- Approach: formatCliError() function classifying YAMLException, ENOENT, EACCES/EPERM, EISDIR errors\n\nImplementation:\n- Added formatCliError() with type guards for YAMLException and NodeSystemError\n- YAML errors: shows reason, line, column, snippet\n- FS errors: shows code, path, helpful hints\n- Generic errors: message only, no stack trace\n- DEBUG=1 env var enables full stack traces\n- Non-zero exit code preserved\n\nVerification:\n- npx tsc --noEmit: OK\n- npm test: 54 passed, 0 failed\n- Manual test with broken YAML: clean error with line/column\n- Manual test DEBUG=1: shows full stack trace\n- Quality gates (validate + render): passed","status":"closed","priority":1,"issue_type":"task","owner":"kaanhakan2005@gmail.com","estimated_minutes":30,"created_at":"2026-02-20T17:38:24.690899+03:00","created_by":"Kaan Akın","updated_at":"2026-02-20T18:03:50.507595+03:00","closed_at":"2026-02-20T18:03:50.507595+03:00","close_reason":"Closed","dependencies":[{"issue_id":"domain-knowledge-kit-t8l.5","depends_on_id":"domain-knowledge-kit-t8l","type":"parent-child","created_at":"2026-02-20T17:38:24.693215+03:00","created_by":"Kaan Akın"}]}
{"id":"domain-knowledge-kit-t8l.6","title":"Add engines field to package.json requiring Node \u003e= 21","description":"The code uses import.meta.dirname (Node 21.2+) in src/utils/paths.ts and test files. Without an engines field in package.json, users on Node 18/20 LTS get a cryptic undefined error at runtime instead of a clear version requirement at install time.","notes":"Preflight: engines field already existed in package.json with node \u003e=21.2.0. Added .npmrc with engine-strict=true for install-time enforcement. All tests pass (44+10), quality gates pass.","status":"closed","priority":1,"issue_type":"task","owner":"kaanhakan2005@gmail.com","estimated_minutes":5,"created_at":"2026-02-20T17:38:34.145141+03:00","created_by":"Kaan Akın","updated_at":"2026-02-20T18:05:35.365284+03:00","closed_at":"2026-02-20T18:05:35.365284+03:00","close_reason":"Closed","dependencies":[{"issue_id":"domain-knowledge-kit-t8l.6","depends_on_id":"domain-knowledge-kit-t8l","type":"parent-child","created_at":"2026-02-20T17:38:34.147195+03:00","created_by":"Kaan Akın"}]}
{"id":"domain-knowledge-kit-t8l.7","title":"Package distribution: include schemas and templates via files field","description":"JSON schemas (tools/domain-pack/schema/) and Handlebars templates (tools/domain-pack/templates/) are resolved at runtime relative to the module location via import.meta.dirname. When the package is installed from npm, these files must be included in the published tarball. Currently there is no files field in package.json, so npm would publish everything including test/. Need a files field listing dist/, tools/domain-pack/schema/, and tools/domain-pack/templates/.","notes":"### Verification\n\n`npm pack --dry-run` output confirms:\n- 97 total files in tarball (47.4 kB packed / 222.1 kB unpacked)\n- Includes: dist/ (all .js, .d.ts, .js.map, .d.ts.map), tools/domain-pack/schema/*.schema.json, tools/domain-pack/templates/*.md.hbs, README.md, package.json\n- Excludes: test/, src/, domain/, docs/, node_modules/, tsconfig.json, AGENTS.md\n\n### Implementation Summary\n- Added `files` field to package.json listing: dist/, tools/domain-pack/schema/, tools/domain-pack/templates/, README.md\n- No LICENSE file exists so it was not listed\n\n### References\n- package.json (single file changed)\n\n### Follow-ups\n- None required","status":"closed","priority":2,"issue_type":"task","owner":"kaanhakan2005@gmail.com","estimated_minutes":30,"created_at":"2026-02-20T17:38:44.266915+03:00","created_by":"Kaan Akın","updated_at":"2026-02-20T18:15:18.770959+03:00","closed_at":"2026-02-20T18:15:18.770959+03:00","close_reason":"Closed","dependencies":[{"issue_id":"domain-knowledge-kit-t8l.7","depends_on_id":"domain-knowledge-kit-t8l","type":"parent-child","created_at":"2026-02-20T17:38:44.269286+03:00","created_by":"Kaan Akın"}]}
{"id":"domain-knowledge-kit-t8l.8","title":"Renderer should clean stale output files from docs/domain/","description":"The renderer writes files to docs/domain/ but never removes old files. If a context or item is removed from the domain model, its generated docs remain as stale orphans. This can cause confusion and stale search results if someone reads the docs directory directly.","notes":"### Verification\n- validate: passed\n- render: passed, rendered 1 file (index.md — no contexts in model)\n- docs/domain/ contains only freshly rendered files after cleanup\n\n### Implementation Summary\nAdded rmSync(outDir, { recursive: true, force: true }) before ensureDir(outDir) in renderDocs(). This deletes the entire docs/domain/ directory and recreates it fresh on each render, ensuring stale files from removed contexts/items are purged. Mirrors the indexer drop-and-recreate approach.\n\n### References\n- src/core/renderer.ts (lines ~256-261)\n\n### Follow-ups\n- None needed","status":"closed","priority":2,"issue_type":"task","owner":"kaanhakan2005@gmail.com","estimated_minutes":30,"created_at":"2026-02-20T17:38:54.583183+03:00","created_by":"Kaan Akın","updated_at":"2026-02-20T18:17:22.86086+03:00","closed_at":"2026-02-20T18:17:22.86086+03:00","close_reason":"Closed","dependencies":[{"issue_id":"domain-knowledge-kit-t8l.8","depends_on_id":"domain-knowledge-kit-t8l","type":"parent-child","created_at":"2026-02-20T17:38:54.585144+03:00","created_by":"Kaan Akın"}]}
{"id":"domain-knowledge-kit-t8l.9","title":"Add --json output flag for machine-readable CLI output","description":"All CLI commands (list, show, search, related, validate, adr show, adr related) only produce human-readable text output. For CI pipelines, scripting, and programmatic Copilot tool integration, a --json flag that outputs structured JSON would be valuable. This is especially important for validate (structured error list) and search (structured results).","notes":"Scope: Add a global --json flag to the Commander program in src/cli.ts. Each command handler checks for this flag and outputs JSON.stringify instead of formatted text. Priority commands: validate (CI needs machine-readable errors), search (agent integration), list (scripting). Lower priority: show (already outputs YAML which is structured), related, adr show, adr related.","status":"closed","priority":2,"issue_type":"feature","owner":"kaanhakan2005@gmail.com","estimated_minutes":60,"created_at":"2026-02-20T17:39:05.183398+03:00","created_by":"Kaan Akın","updated_at":"2026-02-20T18:23:35.754349+03:00","closed_at":"2026-02-20T18:23:35.754349+03:00","close_reason":"Closed","dependencies":[{"issue_id":"domain-knowledge-kit-t8l.9","depends_on_id":"domain-knowledge-kit-t8l","type":"parent-child","created_at":"2026-02-20T17:39:05.185526+03:00","created_by":"Kaan Akın"}]}
{"id":"domain-knowledge-kit-tka","title":"ADR Content","description":"**Title**: Adopt Vertical Slice Architecture","status":"tombstone","priority":2,"issue_type":"task","created_at":"2026-02-20T19:20:01.143689+03:00","updated_at":"2026-02-20T19:20:17.575891+03:00","deleted_at":"2026-02-20T19:20:17.575891+03:00","deleted_by":"batch delete","delete_reason":"batch delete","original_type":"task"}
{"id":"domain-knowledge-kit-tsu","title":"Documentation Updates","description":"Update `README.md` to reflect the new project structure:","status":"tombstone","priority":2,"issue_type":"task","created_at":"2026-02-20T19:20:01.060477+03:00","updated_at":"2026-02-20T19:20:17.575891+03:00","deleted_at":"2026-02-20T19:20:17.575891+03:00","deleted_by":"batch delete","delete_reason":"batch delete","original_type":"task"}
{"id":"domain-knowledge-kit-v37","title":"Add CLI integration tests for command handlers","description":"All 200 existing tests are unit tests against core modules. The command handlers in src/commands/*.ts (option parsing, output formatting, exit codes) have zero test coverage. Add integration tests that invoke the CLI commands and verify output and exit codes.","status":"closed","priority":3,"issue_type":"task","owner":"kaanhakan2005@gmail.com","created_at":"2026-02-20T17:48:15.617659+03:00","created_by":"Kaan Akın","updated_at":"2026-02-20T18:28:34.498605+03:00","closed_at":"2026-02-20T18:28:34.498605+03:00","close_reason":"Duplicate of t8l.10."}
{"id":"domain-knowledge-kit-vrf","title":"Package Verification","description":"- Verify `package.json` `bin` entry still works: `dist/cli.js` should be the compiled entry point","status":"tombstone","priority":2,"issue_type":"task","created_at":"2026-02-20T19:20:01.086133+03:00","updated_at":"2026-02-20T19:20:17.575891+03:00","deleted_at":"2026-02-20T19:20:17.575891+03:00","deleted_by":"batch delete","delete_reason":"batch delete","original_type":"task"}
{"id":"domain-knowledge-kit-vwg","title":"Acceptance Criteria","description":"- `npm test` passes with all tests at new locations","status":"tombstone","priority":2,"issue_type":"task","created_at":"2026-02-20T19:20:00.893894+03:00","updated_at":"2026-02-20T19:20:17.575891+03:00","deleted_at":"2026-02-20T19:20:17.575891+03:00","deleted_by":"batch delete","delete_reason":"batch delete","original_type":"task"}
{"id":"domain-knowledge-kit-wmy","title":"Test Migration Map","description":"| From | To | Rationale |","status":"tombstone","priority":2,"issue_type":"task","created_at":"2026-02-20T19:20:00.862123+03:00","updated_at":"2026-02-20T19:20:17.575891+03:00","deleted_at":"2026-02-20T19:20:17.575891+03:00","deleted_by":"batch delete","delete_reason":"batch delete","original_type":"task"}
{"id":"domain-knowledge-kit-wrl","title":"Current State (before this ticket)","description":"```typescript","status":"tombstone","priority":2,"issue_type":"task","created_at":"2026-02-20T19:20:00.838996+03:00","updated_at":"2026-02-20T19:20:17.575891+03:00","deleted_at":"2026-02-20T19:20:17.575891+03:00","deleted_by":"batch delete","delete_reason":"batch delete","original_type":"task"}
{"id":"domain-knowledge-kit-xto","title":"Add files field to package.json for npm distribution","description":"package.json lacks a 'files' field. The CLI depends on schemas (tools/domain-pack/schema/) and Handlebars templates (tools/domain-pack/templates/) at runtime. Without an explicit 'files' field, an npm publish may not include these, causing runtime failures when installed as a dependency.","status":"closed","priority":2,"issue_type":"task","owner":"kaanhakan2005@gmail.com","created_at":"2026-02-20T17:48:28.956644+03:00","created_by":"Kaan Akın","updated_at":"2026-02-20T18:28:33.803945+03:00","closed_at":"2026-02-20T18:28:33.803945+03:00","close_reason":"Duplicate of t8l.7."}
{"id":"domain-knowledge-kit-yg3","title":"Implementation Notes","description":"- `adr-show.ts` lookups ADRs by ID from `model.adrs` map and prints YAML/JSON","status":"tombstone","priority":2,"issue_type":"task","created_at":"2026-02-20T19:20:00.786098+03:00","updated_at":"2026-02-20T19:20:17.575891+03:00","deleted_at":"2026-02-20T19:20:17.575891+03:00","deleted_by":"batch delete","delete_reason":"batch delete","original_type":"task"}
